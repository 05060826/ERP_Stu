
@{
    ViewData["Title"] = "Index";
}

<h1>出货列表</h1>


<button type="button" class="layui-btn layui-btn-normal">添加出货</button>
<script src="~/layuiadmin/layui/layui.js"></script>
<link href="~/layuiadmin/layui/css/layui.css" rel="stylesheet" />
@*<script src="~b/jquery/dist/jquery.js"></script>*@


<button type="button" class="layui-btn layui-btn-normal">添加出货</button>

<p>
    <input type="text" placeholder="请输入单据号或客户或备注" id="where" />
    日期：<input type="date" id="date" />
    <select id="xiao">
        <option value="-1" disabled>销售人员</option>
    </select>
    <select id="shou">
        <option value="-1" >收款状态</option>
        <option value="0" >未付款</option>
        <option value="1" >已付款</option>
        <option value="2" >已退款</option>
        <option value="3" >未退款</option>

    </select>
    <button type="button" class="layui-btn layui-btn-radius" id="Cha">查询</button>

</p>


<table id="tb" class="layui-table" lay-skin="line">
    <thead>
        <tr>
            <td>单据日期</td>
            <td>单据编号</td>
            <td>客户</td>
            <td>销售金额</td>
            <td>优惠后金额</td>
            <td>已付款</td>
            <td>收款状态</td>
            <td>操作</td>

        </tr>

    </thead>


</table>


<script src="~/lib/jquery/dist/jquery.js"></script>


<script>


    $(function () {
        Xiao();
        Show();

    })

    function Xiao() {

        $.ajax({
            url: "https://localhost:44300/api/showXiao?",
            type: "get",
            dataType: "json",
            contentType: "application/json",
            success: function (result) {
                $("#xiao").empty();
                var str = "";
                str += "<option value='-1'>销售人员</option>"
                $.each(result, function (i,n) {
                    str += "<option value='"+n.seId+"' >"+n.seName+"</option>"

                })
                $("#xiao").append(str);


            }
        })

    }

    $("#Cha").click(function () {
        Show();
    })



    function Show() {
        var where = $("#where").val();
        var date = $("#date").val();
        var xiao = parseInt($("#xiao").val());
        var shou = parseInt($("#shou").val());
        //
        alert(where/+date/+xiao/+shou)
        $.ajax({
            url: "https://localhost:44300/api/show?where = " + where + " & date=" + date + " & xiao" + xiao + " & shou=" + shou,
            type: "get",
            dataType: "json",
            contentType: "application/json",
            success: function (result) {
                ShowList(result)

            }
        })

    }

    function ShowList(result) {
        var str = "";
        var state = "";


        $("#tb tr:gt(0)").empty();
        $.each(result, function (i, n) {

            if (n.cState == 0) {
                state = "未付款"

            }
            else if (n.cState == 1) {
                state = "已付款"
            }
            else if (n.cState == 2) {
                state = "已退款"
            }
            else {
                state = "未退款"
            }

            str += "<tbody><tr><td>" + n.cTime + "</td>";
            str += "<td>" + n.cleaNumber + "</td>";
            str += "<td>" + n.clientName + "</td>";
            str += "<td>" + (n.number * n.sellMoney) + "</td>";
            str += "<td>" + n.sMoney + "</td>";
            str += "<td>" + n.sMoney + "</td>";
            str += "<td>" + state + "</td>";
            str += "<td><a href='javascript: Shan(" + n.ClearId + ")'>删除|</a><a href='javascript: Xiu(" + n.ClearId + ")'>修改|</a>  </td ></tr></tbody> ";

        })
        $("#tb").append(str);

    }

    function Shan(id) {



    }
    function Xiu(id) {


    }

    $("#Btn_Add").click(function () {
        location.href = "/OutStock/Create";

    })


</script>


